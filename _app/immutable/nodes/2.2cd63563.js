import{s as ze,f as D,a as Q,l as H,g as I,h as P,d as y,c as $,m as J,j as S,k as on,i as W,x as A,A as ie,B,y as ke,C as Ee,D as Se,E as It,o as Pt,e as Le,n as se,p as qt,F as oe,G as cn,H as Tt,I as Lt,J as fn}from"../chunks/scheduler.717c9556.js";import{S as Ye,i as Xe,b as lt,d as st,m as rt,a as ot,t as it,e as ct}from"../chunks/index.041f9d32.js";import{b as Mt}from"../chunks/paths.9ba48f06.js";const an=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function ne(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}let Y;function un(t){const e=Y.__externref_table_alloc();return Y.__wbindgen_externrefs.set(e,t),e}function Be(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const s=t.description;return s==null?"Symbol":`Symbol(${s})`}if(e=="function"){const s=t.name;return typeof s=="string"&&s.length>0?`Function(${s})`:"Function"}if(Array.isArray(t)){const s=t.length;let o="[";s>0&&(o+=Be(t[0]));for(let r=1;r<s;r++)o+=", "+Be(t[r]);return o+="]",o}const l=/\[object ([^\]]+)\]/.exec(toString.call(t));let n;if(l&&l.length>1)n=l[1];else return toString.call(t);if(n=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:n}function dn(t,e){return t=t>>>0,ye().subarray(t/1,t/1+e)}let ue=null;function he(){return(ue===null||ue.buffer.detached===!0||ue.buffer.detached===void 0&&ue.buffer!==Y.memory.buffer)&&(ue=new DataView(Y.memory.buffer)),ue}function xe(t,e){return t=t>>>0,wn(t,e)}let ve=null;function ye(){return(ve===null||ve.byteLength===0)&&(ve=new Uint8Array(Y.memory.buffer)),ve}function Ve(t,e){try{return t.apply(this,e)}catch(l){const n=un(l);Y.__wbindgen_exn_store(n)}}function qe(t){return t==null}function ft(t,e,l){if(l===void 0){const i=Ae.encode(t),c=e(i.length,1)>>>0;return ye().subarray(c,c+i.length).set(i),Me=i.length,c}let n=t.length,s=e(n,1)>>>0;const o=ye();let r=0;for(;r<n;r++){const i=t.charCodeAt(r);if(i>127)break;o[s+r]=i}if(r!==n){r!==0&&(t=t.slice(r)),s=l(s,n,n=r+t.length*3,1)>>>0;const i=ye().subarray(s+r,s+n),c=Ae.encodeInto(t,i);r+=c.written,s=l(s,n,r,1)>>>0}return Me=r,s}function _n(t){const e=Y.__wbindgen_externrefs.get(t);return Y.__externref_table_dealloc(t),e}let Te=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});Te.decode();const hn=2146435072;let je=0;function wn(t,e){return je+=e,je>=hn&&(Te=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),Te.decode(),je=e),Te.decode(ye().subarray(t,t+e))}const Ae=new TextEncoder;"encodeInto"in Ae||(Ae.encodeInto=function(t,e){const l=Ae.encode(t);return e.set(l),{read:t.length,written:l.length}});let Me=0;function bn(t){const e=Y.generate_puz(t);if(e[3])throw _n(e[2]);var l=dn(e[0],e[1]).slice();return Y.__wbindgen_free(e[0],e[1]*1,1),l}const gn=new Set(["basic","cors","default"]);async function pn(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(n){if(t.ok&&gn.has(t.type)&&t.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n);else throw n}const l=await t.arrayBuffer();return await WebAssembly.instantiate(l,e)}else{const l=await WebAssembly.instantiate(t,e);return l instanceof WebAssembly.Instance?{instance:l,module:t}:l}}function mn(){const t={};return t.wbg={},t.wbg.__wbg_Error_52673b7de5a0ca89=function(e,l){return Error(xe(e,l))},t.wbg.__wbg___wbindgen_boolean_get_dea25b33882b895b=function(e){const l=e,n=typeof l=="boolean"?l:void 0;return qe(n)?16777215:n?1:0},t.wbg.__wbg___wbindgen_debug_string_adfb662ae34724b6=function(e,l){const n=Be(l),s=ft(n,Y.__wbindgen_malloc,Y.__wbindgen_realloc),o=Me;he().setInt32(e+4*1,o,!0),he().setInt32(e+4*0,s,!0)},t.wbg.__wbg___wbindgen_in_0d3e1e8f0c669317=function(e,l){return e in l},t.wbg.__wbg___wbindgen_is_function_8d400b8b1af978cd=function(e){return typeof e=="function"},t.wbg.__wbg___wbindgen_is_object_ce774f3490692386=function(e){const l=e;return typeof l=="object"&&l!==null},t.wbg.__wbg___wbindgen_is_string_704ef9c8fc131030=function(e){return typeof e=="string"},t.wbg.__wbg___wbindgen_is_undefined_f6b95eab589e0269=function(e){return e===void 0},t.wbg.__wbg___wbindgen_jsval_loose_eq_766057600fdd1b0d=function(e,l){return e==l},t.wbg.__wbg___wbindgen_memory_a342e963fbcabd68=function(){return Y.memory},t.wbg.__wbg___wbindgen_number_get_9619185a74197f95=function(e,l){const n=l,s=typeof n=="number"?n:void 0;he().setFloat64(e+8*1,qe(s)?0:s,!0),he().setInt32(e+4*0,!qe(s),!0)},t.wbg.__wbg___wbindgen_string_get_a2a31e16edf96e42=function(e,l){const n=l,s=typeof n=="string"?n:void 0;var o=qe(s)?0:ft(s,Y.__wbindgen_malloc,Y.__wbindgen_realloc),r=Me;he().setInt32(e+4*1,r,!0),he().setInt32(e+4*0,o,!0)},t.wbg.__wbg___wbindgen_throw_dd24417ed36fc46e=function(e,l){throw new Error(xe(e,l))},t.wbg.__wbg_buffer_80c3d21a2d45e1d1=function(e){return e.buffer},t.wbg.__wbg_call_2d27a686049b7329=function(){return Ve(function(e,l){return e.call(l)},arguments)},t.wbg.__wbg_done_fcbdc8e742555be7=function(e){return e.done},t.wbg.__wbg_entries_362c9657bffe80f8=function(e){return Object.entries(e)},t.wbg.__wbg_get_215e8dab4f6661ba=function(){return Ve(function(e,l){return Reflect.get(e,l)},arguments)},t.wbg.__wbg_get_35f2fc2af18c2cd7=function(e,l){return e[l>>>0]},t.wbg.__wbg_get_with_ref_key_bb8f74a92cb2e784=function(e,l){return e[l]},t.wbg.__wbg_instanceof_ArrayBuffer_0cba38be0569b8d3=function(e){let l;try{l=e instanceof ArrayBuffer}catch{l=!1}return l},t.wbg.__wbg_instanceof_Uint8Array_5c991805ce5cd01f=function(e){let l;try{l=e instanceof Uint8Array}catch{l=!1}return l},t.wbg.__wbg_isArray_b4aaf3b8d9b87b25=function(e){return Array.isArray(e)},t.wbg.__wbg_isSafeInteger_445ebac293d04c4f=function(e){return Number.isSafeInteger(e)},t.wbg.__wbg_iterator_c10e88a25f6ae12c=function(){return Symbol.iterator},t.wbg.__wbg_length_51b58c9eed7b7afc=function(e){return e.length},t.wbg.__wbg_length_f8433525214ae240=function(e){return e.length},t.wbg.__wbg_new_06e55014b923c22a=function(e){return new Uint8Array(e)},t.wbg.__wbg_new_593b87c6effc3ede=function(){return new Object},t.wbg.__wbg_new_5daa7bf3c0dc3d42=function(){return new Map},t.wbg.__wbg_next_c36573b358ac0e7e=function(e){return e.next},t.wbg.__wbg_next_ec2a0d4ed997e75a=function(){return Ve(function(e){return e.next()},arguments)},t.wbg.__wbg_set_14e64b9d34b0258b=function(e,l,n){return e.set(l,n)},t.wbg.__wbg_set_3b37eef9a13e43eb=function(e,l,n){e.set(l,n>>>0)},t.wbg.__wbg_set_3fda3bac07393de4=function(e,l,n){e[l]=n},t.wbg.__wbg_value_7afa23dc7a9d272f=function(e){return e.value},t.wbg.__wbindgen_cast_2241b6af4c4b2941=function(e,l){return xe(e,l)},t.wbg.__wbindgen_init_externref_table=function(){const e=Y.__wbindgen_externrefs,l=e.grow(4);e.set(0,void 0),e.set(l+0,void 0),e.set(l+1,null),e.set(l+2,!0),e.set(l+3,!1)},t}function vn(t,e){return Y=t.exports,Ut.__wbindgen_wasm_module=e,ue=null,ve=null,Y.__wbindgen_start(),Y}async function Ut(t){if(Y!==void 0)return Y;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof t>"u"&&(t=new URL(""+new URL("../assets/xword_puz_bg.144c0835.wasm",import.meta.url).href,self.location));const e=mn();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:l,module:n}=await pn(await t,e);return vn(l,n)}const Ot=(t,e)=>{let l=[];for(let n=0;n<t.length;n+=e){const s=t.substring(n,n+e);l.push(s)}return l},We=(t,e)=>t.reduce((l,n,s)=>{let o=e(n,s);return o!=null&&l.push(o),l},[]),yn=t=>(e,l)=>{const n=t(e),s=t(l);for(let o=0;o<n.length;o++){if(n[o]<s[o])return-1;if(n[o]>s[o])return 1}return 0},Ue=({grid:t,width:e,height:l})=>{let n=1;const s=({idx:r,topBounded:i,leftBounded:c})=>{const u=t[r],_=i||c;u.number=null,i?u.downClue??(u.downClue=""):u.downClue=null,c?u.acrossClue??(u.acrossClue=""):u.acrossClue=null,!u.wall&&_&&(u.number=n,n++)},o=(r,i)=>{if(r<0||i<0||r>=e||i>=l)return!0;const c=i*e+r;return t[c].wall};for(let r=0;r<l;r++)for(let i=0;i<e;i++){const c=r*e+i,u=o(i,r-1)&&!o(i,r+1),_=o(i-1,r)&&!o(i+1,r);s({idx:c,topBounded:u,leftBounded:_})}},Oe=28,Rt=29,Nt=30,xt=31,at=t=>{if(t<65||t>90)throw new Error("found unexpected character in fill");return t-65},An=t=>(Ue(t),{fill:kn(t),across:We(t.grid,e=>e.acrossClue),down:We(t.grid,e=>e.downClue)}),kn=({grid:t,width:e,height:l})=>{let n;const s=(_,h,b)=>{const v=n;for(;n<t.length&&b(t[n]);)n++;let g=n-v;for(;g>0;)if(g==1){c(_);break}else if(g==2){c(_),c(_);break}else{const R=Math.min(g,258);g-=R,c(h),u(R-2)}},o=[0];let r=8;const i=(_,h)=>{const b=o.length-1;if(h<=r){r-=h;const v=_<<r&255;o[b]|=v}else{const v=_>>h-r&255;r+=8,r-=h;const g=_<<r&255;o[b]|=v,o.push(g)}},c=_=>i(_,5),u=_=>i(_,8);if(e>256||e==0)throw new Error("unsupported width");if(u(e-1),l>256||l==0)throw new Error("unsupported height");for(u(l-1),n=0;n<t.length;)if(t[n].wall)s(Nt,xt,_=>_.wall);else if(t[n].fill==="")s(Oe,Rt,_=>!_.wall&&_.fill==="");else{const _=t[n].fill,h=at(_.charCodeAt(0)),b=_.length===1?Oe:at(_.charCodeAt(1));c(h),c(b),n++}return Uint8Array.from(o).toBase64({omitPadding:!0})},En=({fill:t,across:e,down:l})=>{const n=Sn(t),s=e.values(),o=l.values();Ue(n);for(let r of n.grid)r.downClue!=null&&(r.downClue=o.next().value),r.acrossClue!=null&&(r.acrossClue=s.next().value);return n},Sn=t=>{const e={fill:"",wall:!1},l={fill:"",wall:!0},n=[],s=Uint8Array.fromBase64(t);let o=0,r=0;const i=_=>{let h=s[o];if(r+_<=8){r+=_;const d=(1<<_)-1;return h>>8-r&d}const b=8-r,v=_-b,g=(1<<b)-1,R=(h&g)<<v;if(o++,h=s[o],r=v,o>=s.length)throw new Error("could not deserialize -- unexpected end of stream");const C=(1<<v)-1,f=h>>8-v&C;return R|f},c=i(8)+1,u=i(8)+1;for(;n.length<c*u;){const _=i(5);if(_<26){let h;const b=i(5);if(b===Oe)h=String.fromCharCode(_+65);else if(b<26)h=String.fromCharCode(_+65,b+65);else throw new Error("could not deserialize -- unexpected fill byte");n.push({fill:h,wall:!1})}else if(_===Oe)n.push({...e});else if(_===Rt){const h=i(8)+2;for(let b=0;b<h;b++)n.push({...e})}else if(_===Nt)n.push({...l});else if(_===xt){const h=i(8)+2;for(let b=0;b<h;b++)n.push({...l})}else throw new Error("could not deserialize -- unexpected control byte")}return{grid:n,width:c,height:u}};const{window:Fn}=an;function ut(t,e,l){const n=t.slice();return n[65]=e[l],n[67]=l,n}function dt(t,e,l){const n=t.slice();n[65]=e[l],n[73]=l;const s=U*n[67]+n[73];n[68]=s;const o=n[2][n[68]];n[69]=o;const r=n[6].get(n[68]);n[70]=r;const i=n[1]&&n[1].x==n[73]&&n[1].y==n[67];return n[71]=i,n}function _t(t){let e;return{c(){e=H("Â Selected")},l(l){e=J(l,"Â Selected")},m(l,n){W(l,e,n)},d(l){l&&y(e)}}}function ht(t){let e,l=t[69].number+"",n;return{c(){e=D("span"),n=H(l),this.h()},l(s){e=I(s,"SPAN",{class:!0});var o=P(e);n=J(o,l),o.forEach(y),this.h()},h(){S(e,"class","cell-number svelte-1oqq1rw")},m(s,o){W(s,e,o),A(e,n)},p(s,o){o[0]&4&&l!==(l=s[69].number+"")&&se(n,l)},d(s){s&&y(e)}}}function Cn(t){let e,l=t[69].fill+"",n;return{c(){e=D("span"),n=H(l),this.h()},l(s){e=I(s,"SPAN",{class:!0});var o=P(e);n=J(o,l),o.forEach(y),this.h()},h(){S(e,"class","cell-fill svelte-1oqq1rw")},m(s,o){W(s,e,o),A(e,n)},p(s,o){o[0]&4&&l!==(l=s[69].fill+"")&&se(n,l)},d(s){s&&y(e)}}}function Dn(t){let e,l=t[70]+"",n;return{c(){e=D("span"),n=H(l),this.h()},l(s){e=I(s,"SPAN",{class:!0});var o=P(e);n=J(o,l),o.forEach(y),this.h()},h(){S(e,"class","cell-fill preview svelte-1oqq1rw")},m(s,o){W(s,e,o),A(e,n)},p(s,o){o[0]&64&&l!==(l=s[70]+"")&&se(n,l)},d(s){s&&y(e)}}}function wt(t){let e,l,n,s,o,r=t[69].number&&ht(t);function i(v,g){return!v[69].fill&&v[70]?Dn:Cn}let c=i(t),u=c(t);function _(...v){return t[32](t[73],t[67],...v)}function h(...v){return t[33](t[73],t[67],...v)}function b(...v){return t[34](t[73],t[67],...v)}return{c(){e=D("div"),r&&r.c(),l=Q(),u.c(),n=Q(),this.h()},l(v){e=I(v,"DIV",{class:!0});var g=P(e);r&&r.l(g),l=$(g),u.l(g),n=$(g),g.forEach(y),this.h()},h(){S(e,"class","cell svelte-1oqq1rw"),oe(e,"selected-area",t[17](t[1],t[73],t[67])),oe(e,"selected",t[71]),oe(e,"wall",t[69].wall),oe(e,"error",t[69].fill.length>0&&t[69].fill.length<t[0])},m(v,g){W(v,e,g),r&&r.m(e,null),A(e,l),u.m(e,null),A(e,n),s||(o=[B(e,"mousedown",_),B(e,"mouseover",h),B(e,"contextmenu",b)],s=!0)},p(v,g){t=v,t[69].number?r?r.p(t,g):(r=ht(t),r.c(),r.m(e,l)):r&&(r.d(1),r=null),c===(c=i(t))&&u?u.p(t,g):(u.d(1),u=c(t),u&&(u.c(),u.m(e,n))),g[0]&131074&&oe(e,"selected-area",t[17](t[1],t[73],t[67])),g[0]&2&&oe(e,"selected",t[71]),g[0]&4&&oe(e,"wall",t[69].wall),g[0]&5&&oe(e,"error",t[69].fill.length>0&&t[69].fill.length<t[0])},d(v){v&&y(e),r&&r.d(),u.d(),s=!1,Se(o)}}}function bt(t){let e,l=ne({length:U}),n=[];for(let s=0;s<l.length;s+=1)n[s]=wt(dt(t,l,s));return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=Le()},l(s){for(let o=0;o<n.length;o+=1)n[o].l(s);e=Le()},m(s,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(s,o);W(s,e,o)},p(s,o){if(o[0]&188487){l=ne({length:U});let r;for(r=0;r<l.length;r+=1){const i=dt(s,l,r);n[r]?n[r].p(i,o):(n[r]=wt(i),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=l.length}},d(s){s&&y(e),Ee(n,s)}}}function gt(t){let e,l,n=t[10].number&&pt(t),s=t[9].number&&mt(t);return{c(){n&&n.c(),e=Q(),s&&s.c(),l=Le()},l(o){n&&n.l(o),e=$(o),s&&s.l(o),l=Le()},m(o,r){n&&n.m(o,r),W(o,e,r),s&&s.m(o,r),W(o,l,r)},p(o,r){o[10].number?n?n.p(o,r):(n=pt(o),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null),o[9].number?s?s.p(o,r):(s=mt(o),s.c(),s.m(l.parentNode,l)):s&&(s.d(1),s=null)},d(o){o&&(y(e),y(l)),n&&n.d(o),s&&s.d(o)}}}function pt(t){let e,l,n=t[10].number+"",s,o,r,i,c,u,_;return{c(){e=D("div"),l=D("label"),s=H(n),o=H("A"),r=Q(),i=D("div"),c=D("input"),this.h()},l(h){e=I(h,"DIV",{class:!0});var b=P(e);l=I(b,"LABEL",{for:!0,class:!0});var v=P(l);s=J(v,n),o=J(v,"A"),v.forEach(y),r=$(b),i=I(b,"DIV",{class:!0});var g=P(i);c=I(g,"INPUT",{id:!0,class:!0,type:!0}),g.forEach(y),b.forEach(y),this.h()},h(){S(l,"for","across-clue"),S(l,"class","svelte-1oqq1rw"),S(c,"id","across-clue"),S(c,"class","fill-width svelte-1oqq1rw"),S(c,"type","text"),S(i,"class","flex-container svelte-1oqq1rw"),S(e,"class","clue svelte-1oqq1rw")},m(h,b){W(h,e,b),A(e,l),A(l,s),A(l,o),A(e,r),A(e,i),A(i,c),ie(c,t[10].acrossClue),u||(_=B(c,"input",t[36]),u=!0)},p(h,b){b[0]&1024&&n!==(n=h[10].number+"")&&se(s,n),b[0]&1024&&c.value!==h[10].acrossClue&&ie(c,h[10].acrossClue)},d(h){h&&y(e),u=!1,_()}}}function mt(t){let e,l,n=t[9].number+"",s,o,r,i,c,u,_;return{c(){e=D("div"),l=D("label"),s=H(n),o=H("D"),r=Q(),i=D("div"),c=D("input"),this.h()},l(h){e=I(h,"DIV",{class:!0});var b=P(e);l=I(b,"LABEL",{for:!0,class:!0});var v=P(l);s=J(v,n),o=J(v,"D"),v.forEach(y),r=$(b),i=I(b,"DIV",{class:!0});var g=P(i);c=I(g,"INPUT",{id:!0,class:!0,type:!0}),g.forEach(y),b.forEach(y),this.h()},h(){S(l,"for","down-clue"),S(l,"class","svelte-1oqq1rw"),S(c,"id","down-clue"),S(c,"class","fill-width svelte-1oqq1rw"),S(c,"type","text"),S(i,"class","flex-container svelte-1oqq1rw"),S(e,"class","clue svelte-1oqq1rw")},m(h,b){W(h,e,b),A(e,l),A(l,s),A(l,o),A(e,r),A(e,i),A(i,c),ie(c,t[9].downClue),u||(_=B(c,"input",t[37]),u=!0)},p(h,b){b[0]&512&&n!==(n=h[9].number+"")&&se(s,n),b[0]&512&&c.value!==h[9].downClue&&ie(c,h[9].downClue)},d(h){h&&y(e),u=!1,_()}}}function In(t){let e,l,n,s,o,r,i,c,u,_,h,b,v,g,R,C,f,d,m,N,x,k,q,V,j,L=t[11]&&_t(),re=ne({length:de}),X=[];for(let T=0;T<re.length;T+=1)X[T]=bt(ut(t,re,T));let Z=t[12]&&gt(t);return{c(){e=D("div"),l=D("div"),n=D("div"),s=D("div"),o=D("input"),r=Q(),i=D("div"),c=H("byÂ "),u=D("input"),_=Q(),h=D("button"),b=H("Export"),L&&L.c(),v=Q(),g=D("button"),R=H("Undo"),f=Q(),d=D("button"),m=H("Redo"),x=Q(),k=D("div");for(let T=0;T<X.length;T+=1)X[T].c();q=Q(),Z&&Z.c(),this.h()},l(T){e=I(T,"DIV",{id:!0,class:!0});var K=P(e);l=I(K,"DIV",{class:!0});var M=P(l);n=I(M,"DIV",{class:!0});var le=P(n);s=I(le,"DIV",{class:!0});var be=P(s);o=I(be,"INPUT",{class:!0,type:!0}),be.forEach(y),r=$(le),i=I(le,"DIV",{class:!0});var ge=P(i);c=J(ge,"byÂ "),u=I(ge,"INPUT",{class:!0,type:!0}),ge.forEach(y),le.forEach(y),_=$(M),h=I(M,"BUTTON",{class:!0});var pe=P(h);b=J(pe,"Export"),L&&L.l(pe),pe.forEach(y),v=$(M),g=I(M,"BUTTON",{class:!0});var Fe=P(g);R=J(Fe,"Undo"),Fe.forEach(y),f=$(M),d=I(M,"BUTTON",{class:!0});var Ce=P(d);m=J(Ce,"Redo"),Ce.forEach(y),M.forEach(y),x=$(K),k=I(K,"DIV",{id:!0,tabindex:!0,style:!0,class:!0});var De=P(k);for(let me=0;me<X.length;me+=1)X[me].l(De);De.forEach(y),q=$(K),Z&&Z.l(K),K.forEach(y),this.h()},h(){S(o,"class","title fill-width svelte-1oqq1rw"),S(o,"type","text"),S(s,"class","flex-container svelte-1oqq1rw"),S(u,"class","fill-width svelte-1oqq1rw"),S(u,"type","text"),S(i,"class","flex-container svelte-1oqq1rw"),S(n,"class","meta svelte-1oqq1rw"),S(h,"class","svelte-1oqq1rw"),S(g,"class","push svelte-1oqq1rw"),g.disabled=C=t[3].length===0,d.disabled=N=t[4].length===0,S(d,"class","svelte-1oqq1rw"),S(l,"class","header svelte-1oqq1rw"),S(k,"id","grid"),S(k,"tabindex","0"),on(k,"grid-template-columns","repeat("+U+", 1fr)"),S(k,"class","svelte-1oqq1rw"),S(e,"id","grid-wrapper"),S(e,"class","svelte-1oqq1rw")},m(T,K){W(T,e,K),A(e,l),A(l,n),A(n,s),A(s,o),ie(o,t[7]),A(n,r),A(n,i),A(i,c),A(i,u),ie(u,t[8]),A(l,_),A(l,h),A(h,b),L&&L.m(h,null),A(l,v),A(l,g),A(g,R),A(l,f),A(l,d),A(d,m),A(e,x),A(e,k);for(let M=0;M<X.length;M+=1)X[M]&&X[M].m(k,null);t[35](k),A(e,q),Z&&Z.m(e,null),V||(j=[B(Fn,"mouseup",t[29]),B(o,"input",t[30]),B(u,"input",t[31]),B(h,"click",t[20]),B(g,"click",t[18]),B(d,"click",t[19]),B(k,"keydown",t[16]),B(k,"contextmenu",Pn)],V=!0)},p(T,K){if(K[0]&128&&o.value!==T[7]&&ie(o,T[7]),K[0]&256&&u.value!==T[8]&&ie(u,T[8]),T[11]?L||(L=_t(),L.c(),L.m(h,null)):L&&(L.d(1),L=null),K[0]&8&&C!==(C=T[3].length===0)&&(g.disabled=C),K[0]&16&&N!==(N=T[4].length===0)&&(d.disabled=N),K[0]&188487){re=ne({length:de});let M;for(M=0;M<re.length;M+=1){const le=ut(T,re,M);X[M]?X[M].p(le,K):(X[M]=bt(le),X[M].c(),X[M].m(k,null))}for(;M<X.length;M+=1)X[M].d(1);X.length=re.length}T[12]?Z?Z.p(T,K):(Z=gt(T),Z.c(),Z.m(e,null)):Z&&(Z.d(1),Z=null)},i:ke,o:ke,d(T){T&&y(e),L&&L.d(),Ee(X,T),t[35](null),Z&&Z.d(),V=!1,Se(j)}}}const de=20,U=20,Pn=t=>t.preventDefault();function qn(t,e,l){let n,s,o,r,i,{cellFillLen:c}=e;const u=a=>Ot(a,c),_=It();let h=[],b=[],v,g=new Map,R="Untitled",C="Anonymous",f=null,d=Array(U*de).fill(null).map(()=>({wall:!1,fill:"",number:null,downClue:null,acrossClue:null}));const m=a=>{l(1,f={x:a.x,y:a.y,x2:a.x,y2:a.y}),N()},N=()=>{if(!f)return;let a=f.y*U+f.x;_("update",{downPattern:j(f),acrossPattern:V(f),cell:d[a]})},x=a=>({x:p,y:w,...E})=>a({x:p,y:w,...E,front:0,back:d.length,step:U}),k=a=>({x:p,y:w,...E})=>{const F=w*U;return a({x:p,y:w,...E,front:F,back:F+U,step:1})},q=({front:a,back:p,step:w,x:E,y:F,x2:z,y2:te})=>{let O=-1,ee=F*U+E;if(d[ee].wall)return null;for(;ee>=a&&!d[ee].wall;ee-=w)O++;const Pe=Ze({x:E,y:F,x2:z,y2:te}),tt={start:Pe.minY*U+Pe.minX,end:Pe.maxY*U+Pe.maxX},ae={start:null,end:null},sn=ee+w;let _e=[];for(ee=sn;ee<p&&!d[ee].wall;ee+=w){ee==tt.start?ae.start=_e.length:ee==tt.end&&(ae.end=_e.length);const Ne=d[ee].fill,rn=Ne.length&&Ne.length!==c;_e.push(rn?"":Ne)}let nt=!1;return ae.start!=null&&ae.end!=null&&(_e=_e.slice(ae.start,ae.end+1),O-=ae.start,nt=!0),{pattern:_e,index:O,exact:nt}},V=k(q),j=x(q),L=({front:a,back:p,step:w,x:E,y:F,word:z,pivotIdx:te})=>{let G=F*U+E-te*w;const O=[];a<=G-w&&O.push({idx:G-w,is:{fill:"",wall:!0}});for(const ee of u(z))O.push({idx:G,is:{fill:ee,wall:!1}}),G+=w;G<p&&O.push({idx:G,is:{fill:"",wall:!0}}),fe("Set fill",O),v.focus(),ce(),N()},re=k(L),X=x(L),Z=({...a})=>re({...f,...a}),T=({...a})=>X({...f,...a}),K=({front:a,step:p,x:w,y:E,grid:F})=>{if(w==null||E==null)return{};let z=w+U*E;if(!F[z])return null;for(;z>=a&&!F[z].wall;z-=p);return F[z+p]},M=k(K),le=x(K),be=({front:a,back:p,step:w,x:E,y:F,word:z,pivotIdx:te})=>{let G=F*U+E-te*w;g.clear();for(const O of u(z))g.set(G,O),G+=w;l(6,g)},ge=k(be),pe=x(be),Fe=({...a})=>ge({...f,...a}),Ce=({...a})=>pe({...f,...a}),De=a=>{let p=f.y*U+f.x;g.clear(),g.set(p,a),l(6,g)},me=()=>{g.clear(),l(6,g)},Bt=a=>{fe("Set fill",[{idx:f.y*U+f.x,is:{wall:!1,fill:a}}]),v.focus(),N()},Ke=(a,p,w)=>{a.preventDefault();const E=w*U+p;fe("Toggle wall",[{idx:E,is:{fill:"",wall:!d[E].wall}}]),ce()},ce=()=>Ue({grid:d,width:U,height:de}),Ge=({event:a,x:p,y:w})=>{a.buttons!=1||(f==null?void 0:f.state)!=="area"||(l(1,f.x2=p,f),l(1,f.y2=w,f),N())},Wt=a=>{switch(a.keyCode){case 37:a.preventDefault(),f&&f.x>0&&m({x:f.x-1,y:f.y});break;case 38:a.preventDefault(),f&&f.y>0&&m({x:f.x,y:f.y-1});break;case 39:a.preventDefault(),f&&f.x<U-1&&m({x:f.x+1,y:f.y});break;case 40:a.preventDefault(),f&&f.y<de-1&&m({x:f.x,y:f.y+1});break;case 8:if(!f)return;if(o){$e("Delete region");break}const p=f.y*U+f.x;d[p].fill.length?fe("Delete cell contents",[{idx:p,is:{fill:""}}]):f.x!=0&&!d[p-1].wall&&m({x:f.x-1,y:f.y});break;default:if(!f)return;if(a.ctrlKey||a.metaKey)switch(a.keyCode){case 67:Qe();break;case 88:Qe(),$e("Cut region");break;case 86:navigator.clipboard.readText().then(w=>{let E,F;try{E=JSON.parse(w),F=En(E)}catch{return}Yt(F)});break;case 90:a.shiftKey?Je():He();break}if(a.ctrlKey||a.altKey||a.metaKey)return;if(a.keyCode>64&&a.keyCode<91){const w=String.fromCharCode(a.keyCode),E=f.y*U+f.x;if(d[E].wall)return;if(d[E].fill.length<c){const F=d[E].fill+w;fe("Type character",[{idx:E,is:{fill:F}}])}}}},zt=(a,p,w)=>{if(!a)return!1;const{minX:E,maxX:F,minY:z,maxY:te}=Ie();return E<=p&&p<=F&&z<=w&&w<=te},fe=(a,p)=>{for(let w of p){const E=Object.keys(w.is);w.was=Object.fromEntries(E.map(F=>[F,d[w.idx][F]])),l(2,d[w.idx]={...d[w.idx],...w.is},d)}h.push({action:a,updates:p}),l(3,h),l(4,b=[]),N()},He=()=>{let a=h.pop();b.push(a);for(let p of a.updates)l(2,d[p.idx]={...d[p.idx],...p.was},d);l(3,h),l(4,b),ce(),v.focus(),N()},Je=()=>{let a=b.pop();h.push(a);for(let p of a.updates)l(2,d[p.idx]={...d[p.idx],...p.is},d);l(3,h),l(4,b),ce(),v.focus(),N()},Yt=a=>{if(!f||f.x+a.width>U||f.y+a.height>de)return;const p=[];let w=0;for(let E=0;E<a.height;E++)for(let F=0;F<a.width;F++){const z=(f.y+E)*U+(f.x+F);p.push({idx:z,is:a.grid[w]}),w++}fe("Paste region",p),ce()},Xt=(a,p)=>{const w=document.createElement("a");w.href=a,w.download=p,document.body.appendChild(w),w.style.display="none",w.click(),w.remove()},Kt=(a,p,w)=>{const E=new Blob([a],{type:w}),F=window.URL.createObjectURL(E);Xt(F,p),setTimeout(()=>window.URL.revokeObjectURL(F),1e3)},Ze=({x:a,y:p,x2:w,y2:E})=>({minX:Math.min(a,w),maxX:Math.max(a,w),minY:Math.min(p,E),maxY:Math.max(p,E)}),Ie=()=>Ze(f),Qe=()=>{if(!f)return;let a=Ie();const p=et(a);let w=An(p);navigator.clipboard.writeText(JSON.stringify(w))},$e=a=>{if(!f)return;const p=[],{minX:w,maxX:E,minY:F,maxY:z}=Ie();for(let te=F;te<=z;te++)for(let G=w;G<=E;G++){const O=te*U+G;p.push({idx:O,is:{fill:"",wall:!1}})}fe(a,p),ce()},et=({minX:a,minY:p,maxX:w,maxY:E})=>{const F=[],z=E-p+1,te=w-a+1;for(let G=p;G<=E;G++)for(let O=a;O<=w;O++){const ee=G*U+O;F.push({...d[ee]})}return{grid:F,width:te,height:z}},Gt=()=>{let a;o?a=Ie():a={minX:0,minY:0,maxX:U-1,maxY:de-1};const p=et(a);Ue(p);const w=[],E=[];for(const O of p.grid)O.number!=null&&(O.acrossClue!=null&&w.push([O.number,O.acrossClue]),O.downClue!=null&&E.push([O.number,O.downClue]));const F=p.grid.map(O=>O.wall?null:O.fill),z={width:p.width,height:p.height,grid:F,acrossClues:w,downClues:E,title:R,author:C},te=bn(z);Kt(te,`${R||"Untitled"}.puz`,"application/octet-stream")};ce(),Pt(async()=>{await Ut()});const Ht=()=>f&&l(1,f.state=null,f);function Jt(){R=this.value,l(7,R)}function Zt(){C=this.value,l(8,C)}const Qt=(a,p,w)=>{w.buttons===1&&(m({x:a,y:p}),l(1,f.state="area",f))},$t=(a,p,w)=>Ge({event:w,x:a,y:p}),en=(a,p,w)=>Ke(w,a,p);function tn(a){qt[a?"unshift":"push"](()=>{v=a,l(5,v)})}function nn(){r.acrossClue=this.value,l(10,r),l(1,f),l(2,d)}function ln(){i.downClue=this.value,l(9,i),l(1,f),l(2,d)}return t.$$set=a=>{"cellFillLen"in a&&l(0,c=a.cellFillLen)},t.$$.update=()=>{t.$$.dirty[0]&6&&l(28,n=f&&d[f.x+f.y*U]),t.$$.dirty[0]&268435456&&l(12,s=n&&!n.wall),t.$$.dirty[0]&2&&l(11,o=f&&(f.x!=f.x2||f.y!=f.y2)),t.$$.dirty[0]&6&&l(10,r=M({...f,grid:d})),t.$$.dirty[0]&6&&l(9,i=le({...f,grid:d}))},[c,f,d,h,b,v,g,R,C,i,r,o,s,m,Ke,Ge,Wt,zt,He,Je,Gt,Z,T,Fe,Ce,De,me,Bt,n,Ht,Jt,Zt,Qt,$t,en,tn,nn,ln]}class Tn extends Ye{constructor(e){super(),Xe(this,e,qn,In,ze,{cellFillLen:0,setAcrossFillAtSelected:21,setDownFillAtSelected:22,setPreviewAcrossAtSelected:23,setPreviewDownAtSelected:24,setPreviewAtSelected:25,clearPreview:26,setFillAtSelected:27},null,[-1,-1,-1])}get setAcrossFillAtSelected(){return this.$$.ctx[21]}get setDownFillAtSelected(){return this.$$.ctx[22]}get setPreviewAcrossAtSelected(){return this.$$.ctx[23]}get setPreviewDownAtSelected(){return this.$$.ctx[24]}get setPreviewAtSelected(){return this.$$.ctx[25]}get clearPreview(){return this.$$.ctx[26]}get setFillAtSelected(){return this.$$.ctx[27]}}function vt(t,e,l){const n=t.slice();return n[16]=e[l],n}function yt(t,e,l){const n=t.slice();return n[19]=e[l],n}function At(t,e,l){const n=t.slice();return n[19]=e[l],n}function Ln(t){let e,l=`<img class="spinner svelte-d82i0w" src="${Mt}/spinner.gif" alt="loading fill suggestions"/>`;return{c(){e=D("div"),e.innerHTML=l,this.h()},l(n){e=I(n,"DIV",{class:!0,"data-svelte-h":!0}),cn(e)!=="svelte-y52rrk"&&(e.innerHTML=l),this.h()},h(){S(e,"class","spinner-container svelte-d82i0w")},m(n,s){W(n,e,s)},p:ke,d(n){n&&y(e)}}}function Mn(t){var m,N,x;let e,l,n=(((m=t[1])==null?void 0:m.length)??"?")+"",s,o,r,i,c=(((N=t[2])==null?void 0:N.length)??"?")+"",u,_,h,b,v=(((x=t[3])==null?void 0:x.length)??"?")+"",g,R,C=t[1]&&kt(t),f=t[2]&&St(t),d=t[3]&&Ct(t);return{c(){e=D("ul"),l=D("li"),s=H(n),o=H(` potential across fills.
        `),C&&C.c(),r=Q(),i=D("li"),u=H(c),_=H(` potential down fills.
        `),f&&f.c(),h=Q(),b=D("li"),g=H(v),R=H(` potential fills for this cell:
        `),d&&d.c()},l(k){e=I(k,"UL",{});var q=P(e);l=I(q,"LI",{});var V=P(l);s=J(V,n),o=J(V,` potential across fills.
        `),C&&C.l(V),V.forEach(y),r=$(q),i=I(q,"LI",{});var j=P(i);u=J(j,c),_=J(j,` potential down fills.
        `),f&&f.l(j),j.forEach(y),h=$(q),b=I(q,"LI",{});var L=P(b);g=J(L,v),R=J(L,` potential fills for this cell:
        `),d&&d.l(L),L.forEach(y),q.forEach(y)},m(k,q){W(k,e,q),A(e,l),A(l,s),A(l,o),C&&C.m(l,null),A(e,r),A(e,i),A(i,u),A(i,_),f&&f.m(i,null),A(e,h),A(e,b),A(b,g),A(b,R),d&&d.m(b,null)},p(k,q){var V,j,L;q&2&&n!==(n=(((V=k[1])==null?void 0:V.length)??"?")+"")&&se(s,n),k[1]?C?C.p(k,q):(C=kt(k),C.c(),C.m(l,null)):C&&(C.d(1),C=null),q&4&&c!==(c=(((j=k[2])==null?void 0:j.length)??"?")+"")&&se(u,c),k[2]?f?f.p(k,q):(f=St(k),f.c(),f.m(i,null)):f&&(f.d(1),f=null),q&8&&v!==(v=(((L=k[3])==null?void 0:L.length)??"?")+"")&&se(g,v),k[3]?d?d.p(k,q):(d=Ct(k),d.c(),d.m(b,null)):d&&(d.d(1),d=null)},d(k){k&&y(e),C&&C.d(),f&&f.d(),d&&d.d()}}}function kt(t){let e,l=ne(t[1].slice(0,Re)),n=[];for(let s=0;s<l.length;s+=1)n[s]=Et(At(t,l,s));return{c(){e=D("div");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){e=I(s,"DIV",{class:!0});var o=P(e);for(let r=0;r<n.length;r+=1)n[r].l(o);o.forEach(y),this.h()},h(){S(e,"class","word-grid svelte-d82i0w")},m(s,o){W(s,e,o);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(s,o){if(o&50){l=ne(s[1].slice(0,Re));let r;for(r=0;r<l.length;r+=1){const i=At(s,l,r);n[r]?n[r].p(i,o):(n[r]=Et(i),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=l.length}},d(s){s&&y(e),Ee(n,s)}}}function Et(t){let e,l,n=t[5](t[19])+"",s,o,r;function i(){return t[7](t[19])}function c(){return t[8](t[19])}return{c(){e=D("a"),l=new Tt(!1),s=Q(),this.h()},l(u){e=I(u,"A",{class:!0});var _=P(e);l=Lt(_,!1),s=$(_),_.forEach(y),this.h()},h(){l.a=s,S(e,"class","svelte-d82i0w")},m(u,_){W(u,e,_),l.m(n,e),A(e,s),o||(r=[B(e,"click",i),B(e,"mouseover",c),B(e,"mouseout",t[9])],o=!0)},p(u,_){t=u,_&2&&n!==(n=t[5](t[19])+"")&&l.p(n)},d(u){u&&y(e),o=!1,Se(r)}}}function St(t){let e,l=ne(t[2].slice(0,Re)),n=[];for(let s=0;s<l.length;s+=1)n[s]=Ft(yt(t,l,s));return{c(){e=D("div");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){e=I(s,"DIV",{class:!0});var o=P(e);for(let r=0;r<n.length;r+=1)n[r].l(o);o.forEach(y),this.h()},h(){S(e,"class","word-grid svelte-d82i0w")},m(s,o){W(s,e,o);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(s,o){if(o&52){l=ne(s[2].slice(0,Re));let r;for(r=0;r<l.length;r+=1){const i=yt(s,l,r);n[r]?n[r].p(i,o):(n[r]=Ft(i),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=l.length}},d(s){s&&y(e),Ee(n,s)}}}function Ft(t){let e,l,n=t[5](t[19])+"",s,o,r;function i(){return t[10](t[19])}function c(){return t[11](t[19])}return{c(){e=D("a"),l=new Tt(!1),s=Q(),this.h()},l(u){e=I(u,"A",{class:!0});var _=P(e);l=Lt(_,!1),s=$(_),_.forEach(y),this.h()},h(){l.a=s,S(e,"class","svelte-d82i0w")},m(u,_){W(u,e,_),l.m(n,e),A(e,s),o||(r=[B(e,"click",i),B(e,"mouseover",c),B(e,"mouseout",t[12])],o=!0)},p(u,_){t=u,_&4&&n!==(n=t[5](t[19])+"")&&l.p(n)},d(u){u&&y(e),o=!1,Se(r)}}}function Ct(t){let e,l=ne(t[3]),n=[];for(let s=0;s<l.length;s+=1)n[s]=Dt(vt(t,l,s));return{c(){e=D("div");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){e=I(s,"DIV",{class:!0});var o=P(e);for(let r=0;r<n.length;r+=1)n[r].l(o);o.forEach(y),this.h()},h(){S(e,"class","letter-grid svelte-d82i0w")},m(s,o){W(s,e,o);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(s,o){if(o&24){l=ne(s[3]);let r;for(r=0;r<l.length;r+=1){const i=vt(s,l,r);n[r]?n[r].p(i,o):(n[r]=Dt(i),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=l.length}},d(s){s&&y(e),Ee(n,s)}}}function Dt(t){let e,l=t[16]+"",n,s,o;function r(){return t[13](t[16])}function i(){return t[14](t[16])}return{c(){e=D("a"),n=H(l),this.h()},l(c){e=I(c,"A",{class:!0});var u=P(e);n=J(u,l),u.forEach(y),this.h()},h(){S(e,"class","svelte-d82i0w")},m(c,u){W(c,e,u),A(e,n),s||(o=[B(e,"click",r),B(e,"mouseover",i),B(e,"mouseout",t[15])],s=!0)},p(c,u){t=c,u&8&&l!==(l=t[16]+"")&&se(n,l)},d(c){c&&y(e),s=!1,Se(o)}}}function Un(t){let e;function l(o,r){return o[0]?Mn:Ln}let n=l(t),s=n(t);return{c(){e=D("div"),s.c(),this.h()},l(o){e=I(o,"DIV",{id:!0,class:!0});var r=P(e);s.l(r),r.forEach(y),this.h()},h(){S(e,"id","cell-data"),S(e,"class","svelte-d82i0w")},m(o,r){W(o,e,r),s.m(e,null)},p(o,[r]){n===(n=l(o))&&s?s.p(o,r):(s.d(1),s=n(o),s&&(s.c(),s.m(e,null)))},i:ke,o:ke,d(o){o&&y(e),s.d()}}}const Re=100;function On(t,e,l){let{dict:n}=e,{acrossFills:s}=e,{downFills:o}=e,{cellFills:r}=e,{cellFillLen:i}=e;const c=It(),u=({entry:m,pivotIdx:N})=>{const x=N*i,k=x+i,q=m.word.slice(0,x),V=m.word.slice(x,k),j=m.word.slice(k);return`${q}<strong>${V}</strong>${j}`},_=m=>c("fillAcross",{word:m.entry.word,pivotIdx:m.pivotIdx}),h=m=>c("previewAcross",{word:m.entry.word,pivotIdx:m.pivotIdx}),b=()=>c("clearPreview"),v=m=>c("fillDown",{word:m.entry.word,pivotIdx:m.pivotIdx}),g=m=>c("previewDown",{word:m.entry.word,pivotIdx:m.pivotIdx}),R=()=>c("clearPreview"),C=m=>c("fillCell",{fill:m}),f=m=>c("previewCell",{fill:m}),d=()=>c("clearPreview");return t.$$set=m=>{"dict"in m&&l(0,n=m.dict),"acrossFills"in m&&l(1,s=m.acrossFills),"downFills"in m&&l(2,o=m.downFills),"cellFills"in m&&l(3,r=m.cellFills),"cellFillLen"in m&&l(6,i=m.cellFillLen)},[n,s,o,r,c,u,i,_,h,b,v,g,R,C,f,d]}class Rn extends Ye{constructor(e){super(),Xe(this,e,On,Un,ze,{dict:0,acrossFills:1,downFills:2,cellFills:3,cellFillLen:6})}}const Vt=2,jt=t=>Ot(t,Vt),Nn=async()=>{const e=await(await fetch(`${Mt}/dict/words.txt`)).text(),l=We(e.split(`
`),Vn),n=new Map;for(const s of l){const o=s.chunks;delete s.chunks;for(const r of o){const i=n.get(r)||[];i.push(s),n.set(r,i)}}return{entries:l,chunkIndex:n,filterFit:xn}};function xn(t,e,l){let n=[],s=new Set;const o=i=>{let c=t[i],u=this.chunkIndex.get(c)||[];for(const _ of u){const h=jt(_.word);if(!(l&&h.length!=t.length)){for(const[b,v]of h.entries())if(v==c){const g=i-b,R=g+h.length,C=e-g;if(C<0||C>=h.length)continue;const f=h[C];if(g<0||g>0&&t[g-1]||R>t.length||R<t.length&&t[R]||!h.every((m,N)=>{const x=t[g+N];return!x||x==m}))continue;n.push({entry:_,pivotIdx:C}),s.add(f)}}}};if(t[e])o(e);else{for(let i=e;i>=0;i--)if(t[i]){o(i);break}for(let i=e;i<t.length;i++)if(t[i]){o(i);break}}n.sort(yn(i=>[-i.entry.score,i.entry.word,i.pivotIdx]));let r=null;return n=n.reduce((i,c)=>(r&&c.pivotIdx==r.pivotIdx&&c.entry==r.entry||(i.push(c),r=c),i),[]),{gridFills:n,cellFills:s}}const Vn=t=>{let[e,l]=t.split(";");if(!e.match(`^([A-Z]{${Vt}})+$`))return null;const n=new Set(jt(e));return l=+l,{word:e,score:l,chunks:n}};function jn(t){let e,l,n,s,o,r,i={cellFillLen:we};return n=new Tn({props:i}),t[6](n),n.$on("update",t[5]),o=new Rn({props:{dict:t[1],downFills:t[2],acrossFills:t[3],cellFills:t[4],cellFillLen:we}}),o.$on("fillAcross",t[7]),o.$on("fillDown",t[8]),o.$on("fillCell",t[9]),o.$on("previewAcross",t[10]),o.$on("previewDown",t[11]),o.$on("previewCell",t[12]),o.$on("clearPreview",t[13]),{c(){e=Q(),l=D("div"),lt(n.$$.fragment),s=Q(),lt(o.$$.fragment),this.h()},l(c){fn("svelte-fs3o2o",document.head).forEach(y),e=$(c),l=I(c,"DIV",{id:!0,class:!0});var _=P(l);st(n.$$.fragment,_),s=$(_),st(o.$$.fragment,_),_.forEach(y),this.h()},h(){document.title="ðŸ«› Peapod Crossword Setter",S(l,"id","body-wrapper"),S(l,"class","svelte-i647o8")},m(c,u){W(c,e,u),W(c,l,u),rt(n,l,null),A(l,s),rt(o,l,null),r=!0},p(c,[u]){const _={};n.$set(_);const h={};u&2&&(h.dict=c[1]),u&4&&(h.downFills=c[2]),u&8&&(h.acrossFills=c[3]),u&16&&(h.cellFills=c[4]),o.$set(h)},i(c){r||(ot(n.$$.fragment,c),ot(o.$$.fragment,c),r=!0)},o(c){it(n.$$.fragment,c),it(o.$$.fragment,c),r=!1},d(c){c&&(y(e),y(l)),t[6](null),ct(n),ct(o)}}}const we=2;function Bn(t,e,l){let n,s=null,o=null,r=null,i=null;Pt(async()=>{l(1,s=await Nn())});const c=(d,m)=>{if(!d||!m)return d||m;let N=new Set;for(const x of m)d.has(x)&&N.add(x);return N},u=d=>{var x;if(n.clearPreview(),(x=d.detail.cell)!=null&&x.wall){l(2,o=null),l(3,r=null),l(4,i=null);return}let m;const N=({pattern:k,index:q,exact:V})=>{if(k.some(j=>j)){const{gridFills:j,cellFills:L}=s.filterFit(k,q,V);return m=c(m,L),j}return null};l(2,o=N(d.detail.downPattern)),l(3,r=N(d.detail.acrossPattern)),l(2,o=o==null?void 0:o.filter(({entry:k,pivotIdx:q})=>{let V=q*we,j=k.word.slice(V,V+we);return m.has(j)})),l(3,r=r==null?void 0:r.filter(({entry:k,pivotIdx:q})=>{let V=q*we,j=k.word.slice(V,V+we);return m.has(j)})),m!=null?(l(4,i=[...m]),i.sort()):l(4,i=null)};function _(d){qt[d?"unshift":"push"](()=>{n=d,l(0,n)})}return[n,s,o,r,i,u,_,d=>n.setAcrossFillAtSelected(d.detail),d=>n.setDownFillAtSelected(d.detail),d=>n.setFillAtSelected(d.detail.fill),d=>n.setPreviewAcrossAtSelected(d.detail),d=>n.setPreviewDownAtSelected(d.detail),d=>n.setPreviewAtSelected(d.detail.fill),d=>n.clearPreview()]}class Xn extends Ye{constructor(e){super(),Xe(this,e,Bn,jn,ze,{})}}export{Xn as component};
